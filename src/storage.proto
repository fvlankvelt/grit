//syntax = "proto3";
edition = "2023";

package storage;

// In-progress snapshots are persisted for snapshot isolation and time-travel
// Each InProgress corresponds to a txId
message InProgress {
    // last readable data at this txId
    uint64 logIdx = 1;
    repeated uint64 txIds = 2;
}

// Committed transactions are written so that conficts can be detected with to-be-committed transactions.
message Transaction {
    repeated bytes touched = 1;
}

message TransactionOperation {
    uint64 txId = 1;
    oneof op {
        bytes touched = 2;
    }
}

message TransactionManagerState {
    uint64 lastTxId = 1;
    repeated uint64 committed = 2;
    repeated uint64 invalid = 4;
}

